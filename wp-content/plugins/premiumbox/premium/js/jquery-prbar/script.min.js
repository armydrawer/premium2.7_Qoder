jQuery(function(g){var y={trigger:"",start_title:"we determine the number of requests...",end_title:"number of requests defined",found_title:"Found: %count% requests",perform_title:"Perform:",step_title:"Step:",run_title:"Run",line_text:"start step %now% of %max% step",end_progress:"action is completed",line_success:"step %now% is success",success:function(){}};g.fn.PrBar=function(r){var t,e=g.extend({},y,void 0,r),r=(g(this),e.trigger),a=e.start_title,s=e.end_title,i=(i=e.found_title).replace("%count%",'<input type="text" name="" class="prbar_input prbar_num_count" value="0" />'),n=e.perform_title,p=e.step_title,o=e.run_title,c=e.line_text,_=e.end_progress,l=e.line_success,d=e.success,u="",b="",v=0,m=0,w=0,f="";function h(r,t){var e=new Date,e=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();g(".prbar_log").after('<div class="prbar_line '+t+'">['+e+"] "+r+"</div>")}function x(e){var r;e<=w?(h(c.replace("%now%",e).replace("%max%",w).replace("%text%",b),""),r="limit="+m+"&num_page="+e,g.ajax({type:"POST",url:u,dataType:"json",data:r,error:function(r,t,e){for(key in g(".prbar_wrap").removeClass("deactive"),h("error:"+t,"color_red"),r)console.log(key+" = "+r[key])},success:function(r){var t;"error"==r.status&&h(r.status_text,"color_red"),"success"==r.status&&h(l.replace("%now%",e).replace("%text%",r.status_text),"color_green"),t=e,r=w/100,r=Math.ceil(t/r),g(".prbar_ind").show(),g(".prbar_ind_text").html(r+"%"),r=Math.ceil(r*g(".prbar_ind").width()/100),g(".prbar_ind_abs").css({width:r+"px"}),x(e+=1)}})):(g(".prbar_wrap").removeClass("deactive"),h(_,"color_green"),d.apply(null,[f]))}return g(document).on("click",r,function(){r='<div class="prbar_shadow js_techwindow"></div><div class="prbar_wrap js_techwindow"><div class="prbar_wrap_ins"><div class="prbar_close"></div><div class="prbar_title"></div><div class="prbar_content"><div class="prbar_num">'+i+'</div><div class="prbar_control"><div class="prbar_input_wrap">'+n+' <input type="text" name="" class="prbar_input prbar_count" value="50" /></div><div class="prbar_input_wrap">'+p+' <input type="text" name="" class="prbar_input prbar_step_num" value="1" /></div><div class="prbar_submit">'+o+'</div><div class="prbar_clear"></div></div><div class="prbar_ind"><div class="prbar_ind_abs"></div><div class="prbar_ind_text"></div></div><div class="prbar_log_wrap"><div class="prbar_log"></div></div></div></div></div>',g("body").append(r),f=g(this);var r=g.trim(g(this).attr("data-title"));return g(".prbar_title").html(r),g(".prbar_shadow, .prbar_wrap").show(),g(".prbar_log_wrap .prbar_line").remove(),g(".prbar_ind").hide(),g(".prbar_ind_text").html("0%"),g(".prbar_ind_abs").css({width:"0px"}),g(".prbar_num_count").val("0"),g(".prbar_control, .prbar_num").hide(),g(".prbar_wrap").addClass("deactive"),(t=g.trim(g(this).attr("data-count-url")))?(h(a,""),g.ajax({type:"POST",url:t,dataType:"json",data:"action=progressbar",error:function(r,t,e){for(key in g(".prbar_wrap").removeClass("deactive"),h("error:"+t,"color_red"),r)console.log(key+" = "+r[key])},success:function(r){g(".prbar_wrap").removeClass("deactive"),"error"==r.status&&h(r.status_text,"color_red"),"success"==r.status&&(h(s,"color_green"),v=parseInt(r.count),b=r.status_text,g(".prbar_num_count").val(v),g(".prbar_num, .prbar_control").show(),u=r.link,g(".prbar_step_num").val("1"))}})):(g(".prbar_wrap").removeClass("deactive"),h("error data-count-url","color_red")),!1}),g(document).on("click",".prbar_wrap:not(.deactive) .prbar_submit",function(){g(".prbar_wrap").addClass("deactive"),(m=parseInt(g(".prbar_count").val()))<1&&(m=1),(v=parseInt(g.trim(g(".prbar_num_count").val())))<1&&(v=1),w=Math.ceil(v/m);var r=parseInt(g(".prbar_step_num").val());return r<1&&(r=1),x(r),!1}),g(document).on("click",".prbar_wrap:not(.deactive) .prbar_close",function(){return g(".prbar_shadow, .prbar_wrap").remove(),!1}),this}});